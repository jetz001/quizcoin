# QuizCoin (QZC) Tokenomics and Smart Contract Roles (Updated)

This document explains the core tokenomics of QuizCoin (QZC), the roles of smart contracts, and game mechanics within the decentralized quiz game ecosystem, updated according to the current smart contract structure.

---

## 1. QuizCoin (QZC) Tokenomics Overview

### 1.1 Max Supply: Unlimited
* QZC has an **unlimited** total supply
* **Minting Mechanism:** QuizCoin tokens are "minted" (newly created) exclusively when players answer quiz questions correctly for the first time **and receive confirmation from the Backend** (whether playing in Solo or Pool mode)

### 1.2 Initial Distribution: None
* There will be **no pre-minting, initial distribution, or airdrops** of QZC tokens
* At the time of QuizCoin contract deployment, the total token supply starts at zero
* Token supply will only begin circulating in the ecosystem when players start earning rewards from answering questions correctly

### 1.3 Treasury / Ecosystem Fund
The project's sustainability and development are supported by a dedicated treasury managed by the Diamond Contract

* **1.3.1 Funding Sources:**
    * **0.5% Reward Fee:** When players answer questions correctly (whether in Solo or Pool mode), 0.5% of the calculated total reward is minted and sent directly to the **Diamond Contract**, which serves as the project's main treasury
    * **Hint Purchase Fees:** QuizCoin tokens that players spend on purchasing Hints are transferred **directly** from players' wallets to the **Diamond Contract (Treasury)**
* **1.3.2 Usage Purposes:**
    * Cover operational expenses such as domain rental costs
    * Development costs
    * Other expenses related to maintaining and developing the QuizCoin ecosystem

---

## 2. Game Mechanics and Features

### 2.1 Game Modes
QuizCoin game has 2 main modes with different reward mechanisms and gameplay:

* **2.1.1 Solo Mode (Levels 1-99):**
    * **Winner:** The first player to answer a question correctly in that round **and receive Backend confirmation** gets the full reward amount for that difficulty level (after deducting 0.5% Treasury fee)
    * **Question Status:** When there's a winner in Solo mode, that question is immediately closed for Solo mode, and no other players can answer in Solo mode for that question round
* **2.1.2 Pool Mode (Levels 1-99):**
    * **Answer Window:** When the first player answers correctly in Pool mode, the system starts a 3-minute countdown (Pool window) to allow other players the opportunity to join and answer
    * **Reward Distribution:** After the Pool window ends (3 minutes), the total reward for that question (after deducting 0.5% Treasury fee) is split equally among all players who answered correctly within that timeframe
* **2.1.3 Level 100 Questions (Special Level):**
    * **Frequency:** Only 1 question per day
    * **Reward:** Correct answerers (whether Solo or Pool) receive a fixed reward of 10,000 QZC **without halving**
    * **Answer Format:** Text box for entering decimal numbers with 2 decimal places, with rounding up when the third decimal is 0.005 (e.g., 0.005 rounds up to 0.01)

### 2.2 Reward Mechanism and Question Answering

* **Rewards for Levels 1-99:** Players receive rewards ranging from 1-5,000 QZC depending on the question's difficulty level
* **Halving Mechanism:** Rewards for levels 1-99 questions are halved ("Halving") every 4 years to control supply and create long-term sustainability
* **Answer Frequency:**
    * **1 Answer per Wallet per Question:** Each wallet can answer each question only once per question round
    * **Repeat Answers Next Day:** Players can answer the same question again the next day if that question remains open
* **Mode Selection:** Each wallet can choose only 1 mode (Solo or Pool) per day and can select a new mode the next day
* **Question Time Reference (Backend Controlled):**
    * **Question Duration (Levels 1-99):** Each question has a 3-minute duration
    * **Question Duration (Level 100):** Level 100 questions have a 1-day duration (24 hours UTC 00:00 - 23:59)

### 2.3 Hint System
* Players can purchase Hints to help answer questions for 10 QZC
* Hint purchase costs are transferred as QuizCoin tokens directly to the Diamond Contract Treasury

### 2.4 Question Generation and Question Bank
* Questions are generated by **Artificial Intelligence (AI)** and correct answers are **Hashed + Salted**
* **2.4.1 Question Generation:**
    * The system calls **AI API (Gemini)** to generate questions stored in the Question Bank; when submitted, they're sent to the blockchain
    * Generated questions are used immediately in that question round and deleted immediately after use
    * If AI API connection fails, the system switches to retrieving questions from the backup Question Bank

* **2.4.2 Question Bank (Backup Question Repository):** A backup Question Bank stores questions for cases of malfunction or inability to connect to AI normally
    * **Storage:** All questions in the Question Bank are generated and stored **Off-chain**, **Hashed + Salted** (including questions, options, and answers), and will not be modified throughout their storage period
    * For Levels 1-99 questions: Stores questions 10 years in advance, approximately 1,752,000 questions
    * For Level 100 questions: Stores 3,650 questions in advance
    * **Maintenance:** This question bank is cleared and regenerated every 10 years to keep questions current and diverse
* **2.4.3 Question Categories:** All questions are exclusively in **Science** and **Mathematics** categories

### 2.5 Comprehensive Quiz System
Besides the existing Question system, there's a more comprehensive Quiz system:

* **2.5.1 Quiz Creation System:**
    * Admins can create Quizzes containing multiple questions
    * Set maximum participants and total rewards
    * Activate and deactivate Quizzes

* **2.5.2 Merkle Tree Verification:**
    * Uses Merkle Proof system for verifying correct answers
    * MerkleFacet manages root submission and proof verification
    * Enhances security and reduces gas costs for answer verification

---

## 3. Smart Contract Mechanisms and Roles (Current Structure)

### 3.1 `QuizCoin.sol` (ERC-20 Token)
* Standard ERC-20 contract for QuizCoin (QZC)
* **No initial token minting** in Constructor (Total Supply starts at 0)
* Uses OpenZeppelin's `AccessControl` for role management
* Features `MINTER_ROLE` that allows only this role to call the `mint()` function to create new tokens
* Includes `MINTER_ROLE()` function for other contracts to reference the Role Hash

### 3.2 `PoolManager.sol`
Acts as the central hub for managing QuizCoin minting and transfers

* `withdrawForUser(address _user, uint256 _amount)`: Called by QuizGameDiamond (Facet) to **mint new tokens** in `_amount` and send directly to `_user` when players answer correctly
* `mintAndTransferToTreasury(uint256 _amount)`: Called by QuizGameDiamond (Facet) to **mint new tokens** in `_amount` and send to Diamond Contract Address (which serves as Treasury)
* `deposit(uint256 _amount)`: Allows admin or authorized contracts to deposit QuizCoin into `PoolManager` for other specific purposes (e.g., adding liquidity, supporting special events) **However, Hint purchase fees are transferred directly from players to Diamond Contract (Treasury) and do not go through this function**
* `setQuizGameDiamondAddress(address _newQuizGameDiamondAddress)`: Added to inform `PoolManager` which Diamond Contract is authorized to call Mint/Withdraw functions
* **Granting `MINTER_ROLE`:** `PoolManager` receives `MINTER_ROLE` on QuizCoin contract during `QuizGameDiamond` initialization

### 3.3 `QuizGameDiamond.sol` (Diamond Proxy)
Main contract users interact with (acting as Proxy) using Diamond Pattern

* Uses Diamond Standard (EIP-2535) for upgradability and feature addition
* **Treasury Role:** Serves as Treasury address (where `buyHint` fees and 0.5% fees are sent)
* In deployment process:
    * OwnershipFacet calls `init(deployer.address)` to set owner
    * QuizGameBaseFacet calls `initializeQuizGame()` for initial setup
    * Sets PoolManager and QuizCoin addresses in AppStorage
    * Grants `MINTER_ROLE` to PoolManager

### 3.4 Diamond Facets Architecture

#### 3.4.1 Core Facets (Diamond Standard)
* **DiamondCutFacet:** Manages adding, modifying, removing functions
* **DiamondLoupeFacet:** Views facets and available functions information
* **OwnershipFacet:** Manages ownership and access control

#### 3.4.2 Game Logic Facets
* **QuizGameBaseFacet:** Basic functions, settings, and getters
    * `initializeQuizGame()`: Game initialization setup
    * Managing PoolManager and QuizCoin addresses
    * Constants like HINT_COST_AMOUNT (10 QZC), rewards, halving periods

* **QuizGameModeFacet:** Manages question creation and answering logic
    * `createQuestion()`: Creates new questions (Admin only)
    * `submitAnswer()`: Submits answers for Solo mode
    * `buyHint()`: Purchases hints using 10 QZC

* **QuizGameRewardFacet:** Manages reward distribution for Pool mode
    * `distributeRewards()`: Distributes rewards to Pool mode players

#### 3.4.3 Extended Game Features Facets
* **QuizParticipationFacet:** Manages participation in multi-question Quizzes
    * `joinQuiz()`: Join a Quiz
    * `submitQuizAnswer()`: Answer Quiz questions with Merkle proof

* **QuizCreationFacet:** Manages Quiz creation and management
    * `createQuiz()`: Create new Quiz
    * `addQuestion()`: Add questions to Quiz
    * `activateQuiz()` / `deactivateQuiz()`: Enable/disable Quiz

* **MerkleFacet:** Manages Merkle Tree verification
    * `submitMerkleRoot()`: Submit Merkle root for Quiz
    * `verifyQuiz()`: Verify answers through Merkle proof

### 3.5 `LibAppStorage.sol` (Shared Storage Library)
* Manages `AppStorage` which stores all QuizGame State Variables that all Facets access together
* **Important Constants:**
    * `HINT_COST_AMOUNT`: 10 QZC
    * `POOL_REWARD_WINDOW_DURATION_SECONDS`: 180 seconds (3 minutes)
    * `REWARD_FOR_LEVEL_1_99`: 5,000 QZC (for levels 1-99)
    * `REWARD_FOR_LEVEL_100`: 10,000 QZC (for level 100)
    * `TREASURY_FEE_PERCENTAGE`: 50 (i.e., 0.5%)
    * `HALVING_PERIOD_SECONDS`: 4 years
* **Role Management:**
    * `DEFAULT_ADMIN_ROLE`: Main admin
    * `REWARD_DISTRIBUTOR_ROLE`: Reward distributor
    * `CREATOR_ROLE`: Question creator

### 3.6 Treasury Fund Operations
* **Hint Purchases:** QuizCoin used for hints (10 QZC) is transferred directly to Diamond Contract (which serves as Treasury)
* **0.5% Fee from Rewards:** When rewards are calculated (both Solo and Pool), 0.5% of that reward is minted by `PoolManager` and transferred to Diamond Contract (Treasury)

### 3.7 Deployment and Initialization
From latest deployment data:
1. Deploy all facets (9 facets)
2. Deploy QuizCoin and PoolManager
3. Deploy QuizGameDiamond proxy
4. Add facets to Diamond via diamondCut()
5. Initialize system:
   - Call `init(deployer.address)` on OwnershipFacet
   - Call `initializeQuizGame()` on QuizGameBaseFacet
   - Set addresses in AppStorage
   - Grant MINTER_ROLE to PoolManager

### 3.8 Current Contract Addresses (BSC Testnet)
* **QuizGameDiamond:** 0x6DDD5b880dc79A093B55573Fe788aF88dB8125ce
* **QuizCoin:** 0x9Fb94E274c7D95AcD10cb7bf5be7cF71a609dc2a
* **PoolManager:** 0x84D614647af9560f8a9f45Bd5340dC17D979CBB0

**Facet Addresses:**
* **DiamondCutFacet:** 0xBcee7702f3051819f4afD1687A7b3C6b904EA137
* **DiamondLoupeFacet:** 0x8A411cD7AaEA790e948fa533fB71646e8fC049b8
* **OwnershipFacet:** 0xfF985f908a29d63ee58c150bcbA5A5c355f481BB
* **QuizGameBaseFacet:** 0xC93580E138d26585F3268Cce9dc3572ad7E0897e
* **QuizGameModeFacet:** 0x56d2EBC9d3B015b8A4C33fff33811b759D7A9316
* **QuizGameRewardFacet:** 0x9E62555b9838345B14b0f48A6D3305F07029e429
* **QuizParticipationFacet:** 0x7957e965214733552E0872a5BbcdA3a1Fa8DE45D
* **QuizCreationFacet:** 0xB3bEC15f12E4c0188c82B1e60Ef25FFa3ECd99F5
* **MerkleFacet:** 0x9EF1AC6FD4E187edf564A5A625877758be4c3d9D

---

## 4. Disclaimer

QuizCoin (QZC) is designed as a utility token for the QuizCoin game ecosystem and should not be considered as an investment or any form of financial instrument. Its value derives solely from its utility within the game. Users should conduct their own research and understand the risks associated with decentralized applications and cryptocurrencies before participating.