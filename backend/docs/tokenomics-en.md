# QuizCoin (QZC) Tokenomics and Smart Contract Roles

This document outlines the core tokenomics of QuizCoin (QZC), the roles of its smart contracts, and the in-game mechanics within the decentralized quiz game ecosystem.

---

## 1. QuizCoin (QZC) Tokenomics Overview

### 1.1 Max Supply: Unlimited
* QZC has an **unlimited** total supply.
* **Minting Mechanism:** QuizCoin tokens are "Minted" (newly created) specifically when a player correctly answers a question in the QuizGame for the first time **and is validated by the Backend** (whether playing in Solo or Pool mode).

### 1.2 Initial Distribution: None
* There will be **no pre-minted tokens, initial distribution, or Airdrops** of QZC.
* At the time of the QuizCoin contract deployment, the total supply of tokens will start at zero.
* The token supply will only begin to circulate in the ecosystem once players start receiving rewards for correctly answering questions.

### 1.3 Treasury / Ecosystem Fund
The sustainability and development of the project are supported by a dedicated treasury, managed by the Diamond Contract.

* **1.3.1 Funding Sources:**
    * **0.5% Reward Fee:** When a player answers a question correctly (in either Solo or Pool mode), 0.5% of the calculated total reward will be Minted and sent directly to the **Diamond Contract**, which serves as the project's main treasury.
    * **Hint Purchase Fees:** QuizCoin tokens spent by players to purchase Hints will be transferred **directly** from the player's wallet to the **Diamond Contract (Treasury)**.
* **1.3.2 Usage Objectives:**
    * Covering operational expenses such as domain rentals.
    * Development Costs.
    * Other expenses related to the maintenance and development of the QuizCoin ecosystem.

---

## 2. Game Mechanics and Features

### 2.1 Game Modes
The QuizCoin game features two main modes with distinct reward and gameplay mechanics:

* **2.1.1 Solo Mode (Levels 1-99):**
    * **Winner:** The first player to answer the question correctly within that question round **and is validated by the Backend** will receive the full reward for that question level (after deducting the 0.5% Treasury fee).
    * **Question Status:** Once there is a winner in Solo Mode, that question is immediately closed for Solo Mode, and no other players can answer in Solo Mode within that question round.
* **2.1.2 Pool Mode (Levels 1-99):**
    * **Answering Period:** When the first player answers a question correctly in Pool Mode, the system starts a 3-minute countdown (Pool Period) to allow other players to participate and answer the question.
    * **Reward Distribution:** After the Pool Period (3 minutes) ends, the total reward for that question (after deducting the 0.5% Treasury fee) will be divided equally among all players who answered correctly within that period.
* **2.1.3 Level 100 Questions (Special Level):**
    * **Frequency:** Only 1 question per day.
    * **Reward:** Correct solvers (whether Solo or Pool) will receive a fixed reward of 10,000 QZC **without Halving**.
    * **Answer Format:** A textbox for entering a 2-decimal place number, with rounding up when the third decimal place is 0.005 (e.g., 0.005 rounds up to 0.01).

### 2.2 Reward and Answering Mechanics

* **Rewards for Levels 1-99:** Players will receive rewards between 1-5,000 QZC, depending on the question's difficulty level.
* **Halving Mechanism:** Rewards for questions at levels 1-99 will be halved ("Halving") every 4 years to control supply and ensure long-term sustainability.
* **Answering Frequency:**
    * **1 Answer per Wallet per Question:** Each wallet can answer a specific question only once per question round.
    * **Repeatable Next Day:** Players can answer the same question again on the following day if the question has not yet been closed.
* **Mode Selection:** Each wallet can select only 1 mode (Solo or Pool) per day and will be able to select a new mode on the following day.
* **Question Time Reference (Controlled by Backend):**
    * **Question Duration (Levels 1-99):** Each question will have a duration of 3 minutes.
    * **Question Duration (Level 100):** Level 100 questions will have a duration of 1 day (24 hours UTC 00:00 - 23:59).

### 2.3 Hint System
* Players can purchase Hints to assist in answering questions.
* The cost of purchasing a Hint will be transferred in QZC tokens directly to the Diamond Contract's Treasury.

### 2.4 Question Generation and Question Bank
* Questions will be generated by **Artificial Intelligence (AI)**, and the correct answers will be **Hashed + Salted**.
* **2.4.1 Question Real-time Generate (Priority):**
    * The system will call the **AI API (Gemini)** to generate questions in real-time (when a new question is due).
    * The generated question will be used immediately in that question round.
    * If the AI API call fails or cannot connect, the system will switch to retrieving questions from the backup **Question Bank** (as per 2.4.2).
    * **Automatic AI Re-engagement:** Once the AI API is operational again, the Backend will automatically switch back to using AI for question generation in subsequent rounds.
* **2.4.2 Question Bank (Backup Question Repository):** A backup Question Bank is maintained to store questions in case of AI connection issues or failures.
    * **Storage:** All questions in the Question Bank will be generated and stored **Off-chain**. They will be **Hashed + Salted** (including the question, options, and answer) and will not be altered during their storage period.
    * For Levels 1-99 questions: Stores questions 10 years in advance, approximately 1,752,000 questions.
    * For Level 100 questions: Stores 3,650 questions in advance.
    * **Maintenance:** This question bank will be cleared and regenerated every 10 years to ensure questions are up-to-date and diverse.
* **2.4.3 Question Categories:** All questions will be exclusively in the **Science** and **Mathematics** categories.

---

## 3. Smart Contract Mechanics and Roles (Current Structure)

### 3.1 `QuizCoin.sol` (ERC-20 Token)
* This is the standard ERC-20 contract for QuizCoin (QZC).
* **No initial token minting** in the Constructor (Total Supply starts at 0).
* Uses OpenZeppelin's `AccessControl` for role management.
* Features a `MINTER_ROLE` that allows only this role to call the `mint()` function to create new tokens.
* Includes a `MINTER_ROLE()` function for other contracts to reference the Role Hash.

### 3.2 `PoolManager.sol`
Acts as the central hub for managing QuizCoin minting and transfers.

* `withdrawForUser(address _user, uint256 _amount)`: This function will be called by `QuizGameDiamond` (Facet) to **Mint new tokens** in the amount of `_amount` and send them directly to `_user` when a player answers correctly.
* `mintAndTransferToTreasury(uint256 _amount)`: This function will be called by `QuizGameDiamond` (Facet) to **Mint new tokens** in the amount of `_amount` and send them to the Diamond Contract Address (which serves as the Treasury).
* `deposit(uint256 _amount)`: This function allows an administrator (Admin) or an authorized contract to deposit QuizCoin into `PoolManager` for other specific purposes (e.g., adding liquidity, supporting special events). **However, fees from purchasing Hints will be transferred directly from the player to the Diamond Contract (Treasury) and will not pass through this function.**
* `setQuizGameDiamondAddress(address _newQuizGameDiamondAddress)`: Added to inform `PoolManager` which Diamond Contract is authorized to call Mint/Withdraw functions.
* **Granting `MINTER_ROLE`:** `PoolManager` will be granted the `MINTER_ROLE` on the `QuizCoin` contract during the initialization of `QuizGameDiamond`.

### 3.3 `QuizGameDiamond.sol` (Diamond Proxy)
This is the main contract users will interact with (acting as a Proxy).

* Uses `UUPSUpgradeable` and `AccessControlUpgradeable`.
* In `initialize()`:
    * Grants `DEFAULT_ADMIN_ROLE` to the Deployer.
    * **Important:** It will `grantRole(QuizCoin.MINTER_ROLE(), PoolManager Address)` to give `PoolManager` the right to Mint QuizCoin tokens.
    * It will call `PoolManager.setQuizGameDiamondAddress(address(this))` to make `PoolManager` aware of the Diamond Contract.
* **Treasury Role:** Serves as the Treasury address (where `buyHint` fees and the 0.5% fee will be sent).

### 3.4 `LibAppStorage.sol` (Library)
* Manages `AppStorage`, which stores all shared State Variables for QuizGame that all Facets can access.
* Contains `TREASURY_FEE_PERCENTAGE` (set as 50 for 0.5%).
* Includes the `_calculateCurrentReward()` function, which calculates rewards after Halving.

### 3.5 `QuizGameModeFacet.sol`
Manages the logic for question creation (`createQuestion`) and answer submission (`submitAnswer`).

* **3.5.1 In `submitAnswer` (Solo Mode):**
    * Calculates `totalReward`.
    * Calculates `treasuryFee = totalReward * 0.5%`.
    * Calls `ds.poolManager.mintAndTransferToTreasury(treasuryFee)` (Mints to Treasury).
    * Calls `ds.poolManager.withdrawForUser(msg.sender, rewardForSoloSolver)` (Mints the remaining to the player).
* **3.5.2 In `buyHint()`:**
    * Players must `approve` QuizCoin to the Diamond Contract Address first.
    * The `HINT_COST_AMOUNT` will be `transferFrom` the player directly to the Diamond Contract (`address(this)`), meaning Hint fees go directly to the Treasury.

### 3.6 `QuizGameRewardFacet.sol`
Manages the logic for reward distribution in Pool Mode (`distributeRewards`).

* **3.6.1 In `distributeRewards`:**
    * Calculates `totalFinalReward`.
    * Calculates `treasuryFee = totalFinalReward * 0.5%`.
    * Calls `ds.poolManager.mintAndTransferToTreasury(treasuryFee)` (Mints to Treasury).
    * Calculates `rewardPerSolver` from the remaining reward.
    * Calls `ds.poolManager.withdrawForUser(solver, rewardPerSolver)` (Mints the remaining to players in the Pool).

### 3.7 Summary of Treasury Fund Operations from Tokenomics:
* **Hint Purchases:** QuizCoin used to purchase Hints will be transferred directly to the Diamond Contract (which acts as the Treasury).
    * *Reference:* `contracts\facets\QuizGameModeFacet.sol::buyHint`
* **0.5% Fee from Rewards:** Once rewards are calculated (for both Solo and Pool modes), 0.5% of that reward will be Minted by `PoolManager` and transferred to the Diamond Contract (Treasury).
    * *Reference:* `contracts\facets\QuizGameModeFacet.sol::submitAnswer`
    * *Reference:* `contracts\facets\QuizGameRewardFacet.sol::distributeRewards`

---

## 4. Disclaimer

QuizCoin (QZC) is designed as an in-game utility token for the QuizCoin game ecosystem and should not be considered an investment or financial instrument. Its value is derived solely from its utility within the game. Users are advised to conduct their own research and understand the risks associated with decentralized applications and cryptocurrency before participating.